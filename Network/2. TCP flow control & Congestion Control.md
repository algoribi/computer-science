# TCP 흐름제어 & 혼잡제어

## TCP(Transmission Control Protocol) 통신

> 신뢰성 있는 전송제어 프로토콜

- TCP에서 데이터의 단위는 세그먼트(Segment)이다.
- TCP는 기본적으로 IP와 함께 사용된다.
- TCP는 unreliable network에서, reliable network를 보장할 수 있도록 하는 프로토콜이다.
  - reliable network를 보장하는 것 : 패킷의 손실, 순서 바뀜, 네트워크의 혼잡 문제, receiver가 overload되는 문제를 보장한다는 것이다.
  - 이런 특성으로 인해 신뢰성있는 프로토콜이라고 한다.

</br>

## 흐름제어(Flow Control)

> 호스트(송신측)와 호스트(수신측) 간의 데이터처리 속도 차이를 해결하기 위한 기법이다.

- 송신자의 데이터 전송 속도가 수신자의 데이터 처리 속도보다 빠를 경우 심각한 문제가 발생할 수 있다.
  - 이럴 경우 수신자는 버퍼를 통해 데이터를 저장한다. 하지만 큐가 꽉 찼는데도 송신자가 계속 데이터를 전송한다면 그대로 데이터 손실이 일어난다.
  - 이러한 손실을 방지하기 위해 송신 측의 데이터 전송량을 수신 측에 따라 조절해야한다.

1.  ### Stop and Wait

    > 전송한 패킷에 대해 매번 확인 응답을 받아야 다음 패킷을 전송하는 방법

    - Stop and Wait은 일정 시간동안 한 개의 Frame밖에 보내지 못하기 때문에 효율성을 개선하고자 나온 방법이 Sliding-Window이다.

2.  ### Sliding-Window

    > 수신측에서 설정한 윈도우(Window) 크기만큼 송신측에서 확인 응답없이 세그먼트를 전송할 수 있게 하여 데이터 흐름을 동적으로 조절하는 제어기법

    - Window : TCP/IP를 사용하는 모든 호스트들은 송신과 수신을 위한 두 개의 Window를 가지고 있다. 호스트들은 실제 데이터를 보내기 전에 3 Way-Handshake를 통해 수신 호스트의 receive window size에 자신의 send window size를 맞추게 된다.

    <img src="img/sliding_window.png">

    1. 송신측은 윈도우(Window)에 포함되는 모든 패킷을 전송하고, 수신측은 패킷을 받았다는 ACK를 보낸다.
       - 이때 Time 안에 각 패킷에 대한 ACK가 오지 않으면 ACK를 받지 못한 패킷에 대해 재전송을 한다.
    2. 송신측은 자신이 전송한 가장 마지막 패킷의 번호와 가장 최근에 받은 ACK의 번호를 기억하며, 패킷의 전달이 확인되면 윈도우를 옆으로 옮겨 다음 패킷들을 전송한다.
       - 이때 수신측에서 데이터를 읽는 속도가 떨어질 경우, WS(Window Size)를 줄여가며 송신측의 데이터 전송을 컨트롤 한다.

</br>

## 혼잡제어(Congestion Control)

> 호스트(송신측의 데이터 전달)와 네트워크 상의 데이터처리 속도 차이를 해결하기 위한 기법이다.
